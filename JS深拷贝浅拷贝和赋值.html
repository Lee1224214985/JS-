<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS深拷贝和浅拷贝和赋值的区别??</title>
</head>

<body>
    <script>
        // // 对象赋值
        // let obj1 = {
        //     name: '浪里行舟',
        //     arr: [1, [2, 3], 4],
        // };
        // let obj2 = obj1;
        // obj2.name = "阿浪";
        // obj2.arr[1] = [5, 6, 7];
        // console.log('obj1', obj1) // obj1 { name: '阿浪', arr: [ 1, [ 5, 6, 7 ], 4 ] }
        // console.log('obj2', obj2) // obj2 { name: '阿浪', arr: [ 1, [ 5, 6, 7 ], 4 ] }

        // // 深拷贝
        // let obj1 = {
        //     name: '浪里行舟',
        //     arr: [1, [2, 3], 4],
        // };
        // let obj4 = deepClone(obj1)
        // obj4.name = "阿浪";
        // obj4.arr[1] = [5, 6, 7]; // 新对象跟原对象不共享内存
        // // 这是个深拷贝的方法
        // function deepClone(obj) {
        //     if (obj === null) return obj;
        //     if (obj instanceof Date) return new Date(obj);
        //     if (obj instanceof RegExp) return new RegExp(obj);
        //     if (typeof obj !== "object") return obj;
        //     let cloneObj = new obj.constructor();
        //     for (let key in obj) {
        //         if (obj.hasOwnProperty(key)) {
        //             // 实现一个递归拷贝
        //             cloneObj[key] = deepClone(obj[key]);
        //         }
        //     }
        //     return cloneObj;
        // }
        // console.log('obj1', obj1) // obj1 { name: '浪里行舟', arr: [ 1, [ 2, 3 ], 4 ] }
        // console.log('obj4', obj4) // obj4 { name: '阿浪', arr: [ 1, [ 5, 6, 7 ], 4 ] }
        // 
        // 浅拷贝
        let obj1 = {
            name: '浪里行舟',
            arr: [1, [2, 3], 4],
        };
        let obj3 = shallowClone(obj1)
        obj3.name = "阿浪";
        obj3.arr[1] = [5, 6, 7];       // 新旧对象还是共享同一块内存
        // 这是个浅拷贝的方法
        function shallowClone(source) {
            var target = {};
            for (var i in source) {
                if (source.hasOwnProperty(i)) {
                    target[i] = source[i];
                }
            }
            return target;
        }
        console.log('obj1', obj1) // obj1 { name: '浪里行舟', arr: [ 1, [ 5, 6, 7 ], 4 ] }
        console.log('obj3', obj3) // obj3 { name: '阿浪', arr: [ 1, [ 5, 6, 7 ], 4 ] }
    </script>
</body>

</html>